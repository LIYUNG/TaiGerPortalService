"use strict";(self.webpackChunkdatta_able_rv18_0_4=self.webpackChunkdatta_able_rv18_0_4||[]).push([[804],{30804:function(n,e,i){i.r(e),i.d(e,{default:function(){return v}});var t=i(18489),s=i(23430),a=i(47313),r=i(44030),o=i(63849),d=i(31616),u=i(65832),c=i(93298),l=i(67203),p=i(47939),f=i(53537),_=i(54991),g=i(51767),h=i(82423),m=i(20688),Z=i(83708),x=(i(31257),i(51426)),y=i(46417);function v(n){var e=(0,a.useState)({error:null,isLoaded:!1,coursesdata:{},analysis:{},confirmModalWindowOpen:!1,analysisSuccessModalWindowOpen:!1,success:!1,student:null,file:"",study_group:"",analyzed_course:"",expand:!0,isAnalysing:!1,isUpdating:!1,isDownloading:!1,res_status:0,res_modal_status:0,res_modal_message:""}),i=(0,s.Z)(e,2),v=i[0],j=i[1];(0,a.useEffect)((function(){var e=n.match.params.student_id?n.match.params.student_id:n.user._id.toString();(0,x.TE)(e).then((function(n){var e=n.data,i=e.data,s=e.success,a=n.status;if(s){var r=i.table_data_string?JSON.parse(i.table_data_string):{};j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,updatedAt:i.updatedAt,coursesdata:r,analysis:i.analysis,student:i.student_id,success:s,res_status:a})}))}else j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,res_status:a})}))}),(function(n){j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,error:!0})}))}))}),[]);var b=(0,a.useState)([{course_chinese:"\u96fb\u5b50\u5b78",course_english:"Electronics",credits:"3",grades:"B"},{course_chinese:"\u8cc7\u6599\u7d50\u69cb",course_english:"Data structure",credits:"3",grades:"A"}]),I=(0,s.Z)(b,2),w=(I[0],I[1],function(){j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{confirmModalWindowOpen:!1})}))}),C=function(){j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{analysisSuccessModalWindowOpen:!1})}))},L=[(0,t.Z)((0,t.Z)({},(0,f.vU)("course_chinese",f.hg)),{},{title:"Courses Name Chinese"}),(0,t.Z)((0,t.Z)({},(0,f.vU)("course_english",f.hg)),{},{title:"Courses Name English"}),(0,t.Z)((0,t.Z)({},(0,f.vU)("credits",f.hg)),{},{title:"Credits"}),(0,t.Z)((0,t.Z)({},(0,f.vU)("grades",f.hg)),{},{title:"Grades"})];return v.isLoaded?v.res_status>=400?(0,y.jsx)(h.Z,{res_status:v.res_status}):(0,y.jsxs)(_.Z,{children:[v.res_modal_status>=400&&(0,y.jsx)(m.Z,{ConfirmError:function(){j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{res_modal_status:0,res_modal_message:""})}))},res_modal_status:v.res_modal_status,res_modal_message:v.res_modal_message}),(0,y.jsx)(o.Z,{className:"sticky-top ",children:(0,y.jsx)(d.Z,{children:(0,y.jsx)(u.Z,{className:"mb-2 mx-0",bg:"dark",text:"light",children:(0,y.jsx)(u.Z.Header,{text:"dark",children:(0,y.jsx)(u.Z.Title,{children:(0,y.jsx)(o.Z,{children:(0,y.jsxs)(d.Z,{className:"my-0 mx-0 text-light",children:[v.student.firstname," ",v.student.lastname," ","Courses"]})})})})})})}),(0,y.jsx)(o.Z,{children:(0,y.jsxs)(d.Z,{sm:12,children:[(0,y.jsx)(u.Z,{className:"mb-2 mx-0",children:(0,y.jsxs)(u.Z.Body,{children:[(0,y.jsx)(o.Z,{children:(0,y.jsxs)(d.Z,{children:[(0,y.jsx)("p",{children:"Please fill the courses you have taken. (Ignore if you are high school student)"}),(0,y.jsxs)("p",{children:[(0,y.jsx)("b",{children:"Only Bachelor's courses "}),"are considered in this table."]})]})}),(0,y.jsx)("br",{}),(0,y.jsx)(f.co,{height:6e3,disableContextMenu:!0,disableExpandSelection:!1,headerRowHeight:30,rowHeight:25,value:v.coursesdata,autoAddRow:!0,onChange:function(n){j((function(e){return(0,t.Z)((0,t.Z)({},e),{},{coursesdata:n})}))},columns:L}),(0,y.jsx)(o.Z,{className:"my-2",children:(0,y.jsxs)(d.Z,{children:["Last update at: ",(0,g.Ny)(v.updatedAt)]})}),(0,y.jsx)(o.Z,{className:"mx-1",children:(0,Z.je)(n.user,v.student._id.toString())&&(0,y.jsx)(c.Z,{onClick:function(){var n=JSON.stringify(v.coursesdata);j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isUpdating:!0})})),(0,x.Cj)(v.student._id.toString(),{student_id:v.student._id.toString(),name:v.student.firstname,table_data_string:n}).then((function(n){var e=n.data,i=e.data,s=e.success,a=n.status;if(s){var r=JSON.parse(i.table_data_string);j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,updatedAt:i.updatedAt,coursesdata:r,confirmModalWindowOpen:!0,success:s,isUpdating:!1,res_modal_status:a})}))}else{var o=n.data.message;j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,isUpdating:!1,res_modal_status:a,res_modal_message:o})}))}}),(function(n){console.log(n),j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,isUpdating:!1})})),alert("Course Update failed. Please try later.")}))},disabled:v.isUpdating,children:v.isUpdating?"Updating":"Update"})})]})}),"Guest"===n.user.role&&(0,y.jsx)(u.Z,{className:"mb-2 mx-0",children:(0,y.jsxs)(u.Z.Body,{children:[(0,y.jsx)(o.Z,{children:"Do you want to see result? Contact our consultant!"}),(0,y.jsx)("br",{})]})}),("Admin"===n.user.role||"Agent"===n.user.role)&&(0,y.jsx)(u.Z,{className:"mb-2 mx-0",children:(0,y.jsxs)(u.Z.Body,{children:[(0,y.jsx)(o.Z,{children:(0,y.jsx)(d.Z,{children:(0,y.jsx)("h4",{children:"Analyser"})})}),(0,y.jsx)("br",{}),(0,y.jsx)(o.Z,{children:(0,y.jsx)(d.Z,{children:(0,y.jsxs)(l.Z.Group,{controlId:"study_group",children:[(0,y.jsx)(l.Z.Label,{children:"Select target group"}),(0,y.jsxs)(l.Z.Control,{as:"select",onChange:function(n){return function(n){n.preventDefault();var e=n.target.value;j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{study_group:e})}))}(n)},children:[(0,y.jsx)("option",{value:"",children:"Select Study Group"}),g.Ue.map((function(n,e){return(0,y.jsx)("option",{value:n.key,children:n.value},e)}))]})]})})}),(0,y.jsx)("br",{}),(0,y.jsx)(o.Z,{className:"mx-1",children:(0,Z.je)(n.user,v.student._id.toString())&&(0,y.jsx)(c.Z,{onClick:function(){""!==v.study_group?(j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isAnalysing:!0})})),(0,x.fA)(v.student._id.toString(),v.study_group).then((function(n){var e=n.data,i=e.data,s=e.success,a=n.status;if(s)j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,analysis:i,analysisSuccessModalWindowOpen:!0,success:s,isAnalysing:!1,res_modal_status:a})}));else{var r=n.data.message;j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,isAnalysing:!1,res_modal_status:a,res_modal_message:r})}))}}),(function(n){j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isLoaded:!0,isAnalysing:!1})})),alert("Make sure that you updated your courses and your credits are number!")}))):alert("Please select study group")},disabled:v.isAnalysing,children:v.isAnalysing?"Analysing":"Analyse"})}),(0,y.jsx)(o.Z,{className:"my-2"}),(0,y.jsxs)(o.Z,{children:[(0,y.jsx)(d.Z,{md:2,children:(0,y.jsx)("p",{children:v.analysis&&v.analysis.isAnalysed?(0,y.jsx)(c.Z,{onClick:function(){j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isDownloading:!0})})),(0,x.Jd)(v.student._id.toString()).then((function(n){var e=n.headers["content-disposition"].split('"')[1],i=n.data;if(0!==i.size){var s=e.split(".");if("pdf"===(s=s.pop())){var a=window.URL.createObjectURL(new Blob([i],{type:"application/pdf"}));window.open(a)}else{var r=window.URL.createObjectURL(new Blob([i])),o=document.createElement("a");o.href=r,o.setAttribute("download",e),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o),j((function(n){return(0,t.Z)((0,t.Z)({},n),{},{isDownloading:!1})}))}}}))},disabled:v.isDownloading,children:"Download"}):"No analysis yet"})})," ",(0,y.jsx)(d.Z,{children:(0,y.jsxs)("p",{className:"my-2",children:["Last analysis at:"," ",v.analysis?(0,g.Ny)(v.analysis.updatedAt):""]})})]}),(0,y.jsx)("br",{})]})})]})}),(0,y.jsxs)(p.Z,{show:v.confirmModalWindowOpen,onHide:w,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,y.jsx)(p.Z.Header,{children:(0,y.jsx)(p.Z.Title,{id:"contained-modal-title-vcenter",children:"Confirmation"})}),(0,y.jsx)(p.Z.Body,{children:"Update transcript successfully"}),(0,y.jsx)(p.Z.Footer,{children:(0,y.jsx)(c.Z,{onClick:w,children:"Close"})})]}),(0,y.jsxs)(p.Z,{show:v.analysisSuccessModalWindowOpen,onHide:C,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,y.jsx)(p.Z.Header,{children:(0,y.jsx)(p.Z.Title,{id:"contained-modal-title-vcenter",children:"Success"})}),(0,y.jsx)(p.Z.Body,{children:"Transcript analysed successfully!"}),(0,y.jsx)(p.Z.Footer,{children:(0,y.jsx)(c.Z,{onClick:C,children:"Close"})})]})]}):(0,y.jsx)("div",{style:g.nT,children:(0,y.jsx)(r.Z,{animation:"border",role:"status",children:(0,y.jsx)("span",{className:"visually-hidden"})})})}},83708:function(n,e,i){i.d(e,{A$:function(){return w},EL:function(){return a},En:function(){return S},H6:function(){return y},HU:function(){return l},S:function(){return r},_$:function(){return b},_D:function(){return o},aH:function(){return _},aT:function(){return j},bX:function(){return C},c9:function(){return O},d0:function(){return A},dJ:function(){return f},dh:function(){return s},el:function(){return m},je:function(){return t},kF:function(){return L},pM:function(){return u},qz:function(){return p},sc:function(){return x},ti:function(){return c},x8:function(){return d},y2:function(){return h},y3:function(){return I},yd:function(){return Z},ye:function(){return v},ys:function(){return g}});var t=function(n,e){return"Admin"===n.role||"Student"===n.role||"Guest"===n.role||!(!n.students||-1===n.students.findIndex((function(n){return n._id.toString()===e})))},s=function(n){return!(!n||!n.language)&&"O"===n.language.english_isPassed},a=function(n){return!(!n||!n.language)&&"O"===n.language.german_isPassed},r=function(n){return!(!n||!n.language)&&!(!n.language||!(n.language.english_isPassed&&"-"!==n.language.english_isPassed||n.language.german_isPassed&&"-"!==n.language.german_isPassed))},o=function(n){return!(!n||!n.university)&&!!(n.university.attended_high_school&&n.university.high_school_isGraduated&&"-"!==n.university.high_school_isGraduated&&n.university.attended_university&&n.university.attended_university_program)},d=function(n,e){if("O"===e.closed)return"CLOSE";if(!e.programId.application_deadline)return"No Data";if(e.programId.application_deadline.includes("olling"))return"Rolling";var i="<TBD>";if(n.application_preference&&""!==n.application_preference.expected_application_date&&(i=parseInt(n.application_preference.expected_application_date)),!e.programId.application_deadline)return"".concat(i,"-<TBD>");var t=e.programId.semester,s=parseInt(e.programId.application_deadline.split("-")[0]),a=parseInt(e.programId.application_deadline.split("-")[1]);return void 0===t?"Err":("WS"===t&&s>9&&(i-=1),"SS"===t&&s>3&&(i-=1),"".concat(i,"-").concat(s,"-").concat(a))},u=function(n){return!!n&&!(!n.expected_application_date||!n.expected_application_semester)},c=function(n){for(var e=0;e<n.length;e+=1)if(void 0===n[e].agents||0===n[e].agents.length)return!1;return!0},l=function(n){for(var e=0;e<n.length;e+=1)if(void 0===n[e].editors||0===n[e].editors.length)return!1;return!0},p=function(n){if(!n.applications)return!1;if(0===n.applications.length)return!1;for(var e=0;e<n.applications.length;e+=1)if(!n.applications[e].decided||void 0!==n.applications[e].decided&&"-"===n.applications[e].decided)return!1;return!0},f=function(n){if(!n.applications)return!0;if(0===n.applications.length)return!0;for(var e=0;e<n.applications.length;e+=1)if(!n.applications[e].decided||void 0!==n.applications[e].decided&&"-"===n.applications[e].decided)return!1;return!0},_=function(n){return 0===n.applying_program_count||void 0===n.applying_program_count},g=function(n){for(var e=0;e<n.length;e+=1)if(n[e].applications.length<n[e].applying_program_count)return!0;return!1},h=function(n){return void 0===n.applications?0:n.applications.filter((function(n){return"O"===n.decided})).length},m=function(n){return void 0===n.applications?0:n.applications.filter((function(n){return"O"===n.closed})).length},Z=function(n){if(void 0===n.applications)return!1;if(0===n.applying_program_count)return!1;if(n.applications.length<n.applying_program_count)return!1;if(!n.applications||0===n.applications.length)return!1;for(var e=0;e<n.applications.length;e+=1)if(!n.applications[e].decided||void 0!==n.applications[e].decided&&"O"!==n.applications[e].decided)return!1;return!0},x=function(n,e){if(void 0===e.applications)return!1;if(0===e.applications.length)return!1;for(var i=0;i<n.length;i+=1)for(var t=0;t<e.applications.length;t+=1)if(!e.applications[t].closed||void 0!==e.applications[t].closed&&"O"!==e.applications[t].closed)return!1;return!0},y=function(n){return!!n.programId.uni_assist&&!!n.programId.uni_assist.includes("Yes")},v=function(n){if(void 0===n.applications)return!1;for(var e=0;e<n.applications.length;e+=1)if("O"===n.applications[e].decided&&n.applications[e].programId.uni_assist&&(n.applications[e].programId.uni_assist.includes("VPD")||n.applications[e].programId.uni_assist.includes("FULL")))return!0;return!1},j=function(n){var e=0;if(void 0===n.applications)return e;for(var i=0;i<n.applications.length;i+=1)if("O"===n.applications[i].decided&&n.applications[i].programId.uni_assist&&(n.applications[i].programId.uni_assist.includes("VPD")||n.applications[i].programId.uni_assist.includes("FULL"))){if(!n.applications[i].uni_assist)continue;if(n.applications[i].uni_assist&&"notneeded"===n.applications[i].uni_assist.status)continue;!n.applications[i].uni_assist||"uploaded"!==n.applications[i].uni_assist.status&&""===n.applications[i].uni_assist.vpd_file_path&&null!==n.applications[i].uni_assist.vpd_file_path||(e+=1)}return e},b=function(n){var e=0;if(void 0===n.applications)return e;for(var i=0;i<n.applications.length;i+=1)if("O"===n.applications[i].decided&&n.applications[i].programId.uni_assist&&(n.applications[i].programId.uni_assist.includes("VPD")||n.applications[i].programId.uni_assist.includes("FULL"))){if(!n.applications[i].uni_assist)continue;if(n.applications[i].uni_assist&&"notneeded"===n.applications[i].uni_assist.status)continue;e+=1}return e},I=function(n){for(var e=0;e<n.doc_modification_thread.length;e+=1)if(!n.doc_modification_thread[e].isFinalVersion)return!1;return!0},w=function(n){return!!n.generaldocs_threads&&-1!==n.generaldocs_threads.findIndex((function(n){return"CV"===n.doc_thread_id.file_type}))},C=function(n){return!!n.generaldocs_threads&&(-1!==n.generaldocs_threads.findIndex((function(n){return"CV"===n.doc_thread_id.file_type}))&&!!n.generaldocs_threads.find((function(n){return"CV"===n.doc_thread_id.file_type})).isFinalVersion)},L=function(n){for(var e=0;e<n.doc_modification_thread.length;e+=1)if(!n.doc_modification_thread[e].isFinalVersion)return!1;return!(n.programId.uni_assist&&n.programId.uni_assist.includes("Yes")&&(!n.uni_assist||"uploaded"!==n.uni_assist.status))},S=function(n){return"O"===n.closed},O=function(n){if(void 0===n.applications)return!1;for(var e=0;e<n.applications.length;e+=1)if("O"===n.applications[e].decided&&n.applications[e].programId.uni_assist&&(n.applications[e].programId.uni_assist.includes("VPD")||n.applications[e].programId.uni_assist.includes("FULL"))){if(!n.applications[e].uni_assist)return!1;if(n.applications[e].uni_assist&&"notneeded"===n.applications[e].uni_assist.status)continue;if(n.applications[e].uni_assist&&("uploaded"!==n.applications[e].uni_assist.status||""===n.applications[e].uni_assist.vpd_file_path))return!1}return!0},A=function(n){return-1===n.generaldocs_threads.findIndex((function(n){return"CV"===n.doc_thread_id.file_type}))}}}]);