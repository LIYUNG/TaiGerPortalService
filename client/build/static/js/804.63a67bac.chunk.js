"use strict";(self.webpackChunkdatta_able_rv18_0_4=self.webpackChunkdatta_able_rv18_0_4||[]).push([[804],{30804:function(e,s,n){n.r(s),n.d(s,{default:function(){return f}});var t=n(18489),a=n(23430),i=n(47313),r=n(44030),d=n(63849),l=n(31616),o=n(65832),c=n(93298),u=n(67203),h=n(47939),Z=n(53537),m=n(54991),x=n(51767),_=n(82423),j=n(20688),p=(n(31257),n(51426)),g=n(46417);function f(e){var s=(0,i.useState)({error:null,isLoaded:!1,coursesdata:{},analysis:{},confirmModalWindowOpen:!1,analysisSuccessModalWindowOpen:!1,success:!1,student:null,file:"",study_group:"",analyzed_course:"",expand:!0,isAnalysing:!1,isUpdating:!1,isDownloading:!1,res_status:0,res_modal_status:0,res_modal_message:""}),n=(0,a.Z)(s,2),f=n[0],y=n[1];(0,i.useEffect)((function(){var s=e.match.params.student_id?e.match.params.student_id:e.user._id.toString();(0,p.TE)(s).then((function(e){var s=e.data,n=s.data,a=s.success,i=e.status;if(a){var r=n.table_data_string?JSON.parse(n.table_data_string):{};y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,updatedAt:n.updatedAt,coursesdata:r,analysis:n.analysis,student:n.student_id,success:a,res_status:i})}))}else y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,res_status:i})}))}),(function(e){y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,error:!0})}))}))}),[]);var b=(0,i.useState)([{course_chinese:"\u96fb\u5b50\u5b78",course_english:"Electronics",credits:"3",grades:"B"},{course_chinese:"\u8cc7\u6599\u7d50\u69cb",course_english:"Data structure",credits:"3",grades:"A"}]),v=(0,a.Z)(b,2),w=(v[0],v[1],function(){y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{confirmModalWindowOpen:!1})}))}),C=function(){y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{analysisSuccessModalWindowOpen:!1})}))},A=[(0,t.Z)((0,t.Z)({},(0,Z.vU)("course_chinese",Z.hg)),{},{title:"Courses Name Chinese"}),(0,t.Z)((0,t.Z)({},(0,Z.vU)("course_english",Z.hg)),{},{title:"Courses Name English"}),(0,t.Z)((0,t.Z)({},(0,Z.vU)("credits",Z.hg)),{},{title:"Credits"}),(0,t.Z)((0,t.Z)({},(0,Z.vU)("grades",Z.hg)),{},{title:"Grades"})];return f.isLoaded?f.res_status>=400?(0,g.jsx)(_.Z,{res_status:f.res_status}):(0,g.jsxs)(m.Z,{children:[f.res_modal_status>=400&&(0,g.jsx)(j.Z,{ConfirmError:function(){y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{res_modal_status:0,res_modal_message:""})}))},res_modal_status:f.res_modal_status,res_modal_message:f.res_modal_message}),(0,g.jsx)(d.Z,{className:"sticky-top ",children:(0,g.jsx)(l.Z,{children:(0,g.jsx)(o.Z,{className:"mb-2 mx-0",bg:"dark",text:"light",children:(0,g.jsx)(o.Z.Header,{text:"dark",children:(0,g.jsx)(o.Z.Title,{children:(0,g.jsx)(d.Z,{children:(0,g.jsxs)(l.Z,{className:"my-0 mx-0 text-light",children:[f.student.firstname," ",f.student.lastname," ","Courses"]})})})})})})}),(0,g.jsx)(d.Z,{children:(0,g.jsxs)(l.Z,{sm:12,children:[(0,g.jsx)(o.Z,{className:"mb-2 mx-0",children:(0,g.jsxs)(o.Z.Body,{children:[(0,g.jsx)(d.Z,{children:(0,g.jsxs)(l.Z,{children:[(0,g.jsx)("p",{children:"Please fill the courses you have taken. (Ignore if you are high school student)"}),(0,g.jsxs)("p",{children:[(0,g.jsx)("b",{children:"Only Bachelor's courses "}),"are considered in this table."]})]})}),(0,g.jsx)("br",{}),(0,g.jsx)(Z.co,{height:6e3,disableContextMenu:!0,disableExpandSelection:!1,headerRowHeight:30,rowHeight:25,value:f.coursesdata,autoAddRow:!0,onChange:function(e){y((function(s){return(0,t.Z)((0,t.Z)({},s),{},{coursesdata:e})}))},columns:A}),(0,g.jsx)(d.Z,{className:"my-2",children:(0,g.jsxs)(l.Z,{children:["Last update at: ",(0,x.Ny)(f.updatedAt)]})}),(0,g.jsx)(d.Z,{className:"mx-1",children:(0,g.jsx)(c.Z,{onClick:function(){var e=JSON.stringify(f.coursesdata);y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isUpdating:!0})})),(0,p.Cj)(f.student._id.toString(),{student_id:f.student._id.toString(),name:f.student.firstname,table_data_string:e}).then((function(e){var s=e.data,n=s.data,a=s.success,i=e.status;if(a){var r=JSON.parse(n.table_data_string);y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,updatedAt:n.updatedAt,coursesdata:r,confirmModalWindowOpen:!0,success:a,isUpdating:!1,res_modal_status:i})}))}else{var d=e.data.message;y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,isUpdating:!1,res_modal_status:i,res_modal_message:d})}))}}),(function(e){console.log(e),y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,isUpdating:!1})})),alert("Course Update failed. Please try later.")}))},disabled:f.isUpdating,children:f.isUpdating?"Updating":"Update"})})]})}),"Guest"===e.user.role&&(0,g.jsx)(o.Z,{className:"mb-2 mx-0",children:(0,g.jsxs)(o.Z.Body,{children:[(0,g.jsx)(d.Z,{children:"Do you want to see result? Contact our consultant!"}),(0,g.jsx)("br",{})]})}),("Admin"===e.user.role||"Agent"===e.user.role)&&(0,g.jsx)(o.Z,{className:"mb-2 mx-0",children:(0,g.jsxs)(o.Z.Body,{children:[(0,g.jsx)(d.Z,{children:(0,g.jsx)(l.Z,{children:(0,g.jsx)("h4",{children:"Analyser"})})}),(0,g.jsx)("br",{}),(0,g.jsx)(d.Z,{children:(0,g.jsx)(l.Z,{children:(0,g.jsxs)(u.Z.Group,{controlId:"study_group",children:[(0,g.jsx)(u.Z.Label,{children:"Select target group"}),(0,g.jsxs)(u.Z.Control,{as:"select",onChange:function(e){return function(e){e.preventDefault();var s=e.target.value;y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{study_group:s})}))}(e)},children:[(0,g.jsx)("option",{value:"",children:"Select Study Group"}),x.Ue.map((function(e,s){return(0,g.jsx)("option",{value:e.key,children:e.value},s)}))]})]})})}),(0,g.jsx)("br",{}),(0,g.jsx)(d.Z,{className:"mx-1",children:(0,g.jsx)(c.Z,{onClick:function(){""!==f.study_group?(y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isAnalysing:!0})})),(0,p.fA)(f.student._id.toString(),f.study_group).then((function(e){var s=e.data,n=s.data,a=s.success,i=e.status;if(a)y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,analysis:n,analysisSuccessModalWindowOpen:!0,success:a,isAnalysing:!1,res_modal_status:i})}));else{var r=e.data.message;y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,isAnalysing:!1,res_modal_status:i,res_modal_message:r})}))}}),(function(e){y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isLoaded:!0,isAnalysing:!1})})),alert("Make sure that you updated your courses and your credits are number!")}))):alert("Please select study group")},disabled:f.isAnalysing,children:f.isAnalysing?"Analysing":"Analyse"})}),(0,g.jsx)(d.Z,{className:"my-2"}),(0,g.jsxs)(d.Z,{children:[(0,g.jsx)(l.Z,{md:2,children:(0,g.jsx)("p",{children:f.analysis&&f.analysis.isAnalysed?(0,g.jsx)(c.Z,{onClick:function(){y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isDownloading:!0})})),(0,p.Jd)(f.student._id.toString()).then((function(e){var s=e.headers["content-disposition"].split('"')[1],n=e.data;if(0!==n.size){var a=s.split(".");if("pdf"===(a=a.pop())){var i=window.URL.createObjectURL(new Blob([n],{type:"application/pdf"}));window.open(i)}else{var r=window.URL.createObjectURL(new Blob([n])),d=document.createElement("a");d.href=r,d.setAttribute("download",s),document.body.appendChild(d),d.click(),d.parentNode.removeChild(d),y((function(e){return(0,t.Z)((0,t.Z)({},e),{},{isDownloading:!1})}))}}}))},disabled:f.isDownloading,children:"Download"}):"No analysis yet"})})," ",(0,g.jsx)(l.Z,{children:(0,g.jsxs)("p",{className:"my-2",children:["Last analysis at:"," ",f.analysis?(0,x.Ny)(f.analysis.updatedAt):""]})})]}),(0,g.jsx)("br",{})]})})]})}),(0,g.jsxs)(h.Z,{show:f.confirmModalWindowOpen,onHide:w,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,g.jsx)(h.Z.Header,{children:(0,g.jsx)(h.Z.Title,{id:"contained-modal-title-vcenter",children:"Confirmation"})}),(0,g.jsx)(h.Z.Body,{children:"Update transcript successfully"}),(0,g.jsx)(h.Z.Footer,{children:(0,g.jsx)(c.Z,{onClick:w,children:"Close"})})]}),(0,g.jsxs)(h.Z,{show:f.analysisSuccessModalWindowOpen,onHide:C,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,g.jsx)(h.Z.Header,{children:(0,g.jsx)(h.Z.Title,{id:"contained-modal-title-vcenter",children:"Success"})}),(0,g.jsx)(h.Z.Body,{children:"Transcript analysed successfully!"}),(0,g.jsx)(h.Z.Footer,{children:(0,g.jsx)(c.Z,{onClick:C,children:"Close"})})]})]}):(0,g.jsx)("div",{style:x.nT,children:(0,g.jsx)(r.Z,{animation:"border",role:"status",children:(0,g.jsx)("span",{className:"visually-hidden"})})})}}}]);